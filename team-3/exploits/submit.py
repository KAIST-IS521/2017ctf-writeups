import requests, json, gnupg
URL = 'http://localhost:3000/submit' # Need to change
GNUPGHOME = ''
gpg = gnupg.GPG(gnupghome=GNUPGHOME)
FINGERPRINT = 'BCBC EEE9 01B3 600D E9DA  1BDB E827 0AAF DCC8 3B80'.replace(' ', '')
with open('passphrase') as f:
    phr = f.read().strip()
PASSPHRASE = phr

def encrypt(data):
  enc = gpg.encrypt(data, 'is521-ta@is521-ta.com', always_trust= True,
                    sign = FINGERPRINT, passphrase= PASSPHRASE)
  if enc.ok:
    return str(enc)
  return False

def toJson(data):
  return json.dumps(data)

def send(fr, to, service, flag):
  param = {'from' : fr, 'to' : to, 'service' : service, 'flag' : flag}
  r = requests.post(URL, data = {'data': encrypt(toJson(param))})
  if r.text == 'Correct flag' : return True
  return False

import sys

if __name__ == '__main__':
    DST = ['Team 1', 'Team 2', 'Team 4', 'Team 5', 'Team TA']

    while True:
        for i, name in enumerate(DST):
            print i, name

        i = int(raw_input())
        flag = raw_input('flag :')
        print DST[i], send('Team 3', DST[i], 'Mall', flag)
